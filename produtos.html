<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos - Farmácia São Benedito</title>
    <meta name="description" content="Confira todos os produtos da Farmácia São Benedito: medicamentos, dermocosméticos, suplementos e muito mais.">
    <meta name="theme-color" content="#1e40af">
    <!-- Canonical (domínio em produção) -->
    <link rel="canonical" href="https://henriquecoan-code.github.io/farmacia/produtos.html">
    <!-- Open Graph básico -->
    <meta property="og:title" content="Produtos - Farmácia São Benedito">
    <meta property="og:description" content="Confira todos os produtos: medicamentos, dermocosméticos, suplementos e mais.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://henriquecoan-code.github.io/farmacia/produtos.html">
    <meta property="og:image" content="https://henriquecoan-code.github.io/farmacia/img/logo.png">
    <meta property="og:image:alt" content="Logomarca da Farmácia São Benedito">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Produtos - Farmácia São Benedito">
    <meta name="twitter:description" content="Confira todos os produtos: medicamentos, dermocosméticos, suplementos e mais.">
    <meta name="twitter:image" content="https://henriquecoan-code.github.io/farmacia/img/logo.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="img/favicon.ico">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="modern/css/modern-styles.css">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
</head>
<body>
    <!-- Skip link para acessibilidade -->
    <a class="skip-link" href="#products-container">Pular para a lista de produtos</a>
    <!-- Header Container -->
    <div id="header-container"></div>

    <!-- Main Content -->
    <main class="main">
        <!-- Filters -->
        <section class="filters">
            <div class="container">
                <div class="filters__content">
                    <div class="filters__categories">
                        <button class="filter-btn filter-btn--active" data-category="all" aria-pressed="true">
                            <i class="fas fa-th-large" aria-hidden="true"></i>
                            Todos
                        </button>
                        <button class="filter-btn" data-category="medicamentos" aria-pressed="false">
                            <i class="fas fa-pills" aria-hidden="true"></i>
                            Medicamentos
                        </button>
                        <button class="filter-btn" data-category="dermocosmeticos" aria-pressed="false">
                            <i class="fas fa-heart" aria-hidden="true"></i>
                            Dermocosméticos
                        </button>
                        <button class="filter-btn" data-category="suplementos" aria-pressed="false">
                            <i class="fas fa-dumbbell" aria-hidden="true"></i>
                            Suplementos
                        </button>
                        <button class="filter-btn" data-category="infantil" aria-pressed="false">
                            <i class="fas fa-baby" aria-hidden="true"></i>
                            Infantil
                        </button>
                    </div>
                    <div class="filters__sort">
                        <select class="sort-select" aria-label="Ordenar produtos">
                            <option value="name">Nome A-Z</option>
                            <option value="price-low">Menor Preço</option>
                            <option value="price-high">Maior Preço</option>
                            <option value="featured">Em Destaque</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <!-- Products Grid -->
        <section class="products-grid">
            <div class="container">
                <div id="products-results-info" class="products-results-info" aria-live="polite" style="margin-bottom:1rem;font-size:.9rem;color:#555"></div>
                <div class="products-grid__container" id="products-container">
                    <!-- Products will be dynamically loaded here -->
                </div>
                <div id="pagination-container" class="pagination" aria-label="Paginação de produtos" style="margin-top:2rem"></div>
            </div>
        </section>
    </main>

    <!-- Footer Container -->
    <div id="footer-container"></div>

    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loading-spinner" role="status" aria-live="polite" aria-busy="true">
        <div class="spinner"></div>
        <p>Carregando produtos...</p>
    </div>

    <!-- Error Message -->
    <div class="error-message" id="error-message" role="alert" aria-live="assertive">
        <p>Erro ao carregar produtos. Tente novamente.</p>
        <button class="btn btn--primary" onclick="location.reload()">Recarregar</button>
    </div>

        <!-- Scripts -->
        <!-- Showcase PoC: ativa modo vitrine via ?vitrine=1 (lê /data/products.json e bloqueia escritas) -->
        <script type="module">
            const params = new URLSearchParams(location.search);
            const showcase = params.get('vitrine') === '1';
            if (showcase) {
                window.SHOWCASE_MODE = true;
                import('./modern/js/bootstrap.js').then(async ({ bootstrap }) => {
                    try { await bootstrap.init(); } catch {}
                    const cacheKey = 'products_cache_vitrine';
                    const ttl = 60 * 60 * 1000; // 60 min
                    bootstrap.firebase.getProducts = async () => {
                        const now = Date.now();
                        try {
                            const cached = JSON.parse(localStorage.getItem(cacheKey) || 'null');
                            if (cached?.items && now - (cached.ts || 0) < ttl) {
                                return cached.items;
                            }
                        } catch {}
                        try {
                            const resp = await fetch('./data/products.json', { cache: 'no-store' });
                            const items = await resp.json();
                            try { localStorage.setItem(cacheKey, JSON.stringify({ items, ts: now })); } catch {}
                            return Array.isArray(items) ? items : [];
                        } catch (e) {
                            console.error('[Showcase] Falha ao carregar ./data/products.json', e);
                            return [];
                        }
                    };
                    ['addProduct','updateProduct','deleteProduct','createOrder','addClient','updateClient','deleteClient']
                        .forEach(m => {
                            if (typeof bootstrap.firebase[m] === 'function') {
                                bootstrap.firebase[m] = async () => { throw new Error('Modo vitrine: operação não permitida'); };
                            }
                        });
                });
            }
        </script>
        <noscript>
            <div class="no-js-warning" style="padding:1rem; text-align:center; background:#fff3cd; color:#664d03;">
                Para visualizar os produtos, ative o JavaScript no seu navegador.
            </div>
        </noscript>
        <script type="module" src="modern/js/produtos-firebase.js"></script>
</body>
</html>